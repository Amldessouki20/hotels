# ุฏููู ุฅุฏุงุฑุฉ ูุฌููุนุงุช ุงููุณุชุฎุฏููู ูุงูุตูุงุญูุงุช ููุฃุฏูู

## ูุธุฑุฉ ุนุงูุฉ

ูุธุงู ุฅุฏุงุฑุฉ ุงูููุงุฏู ูููุฑ ูุฑููุฉ ูุงููุฉ ููุฃุฏูู ูู ุฅูุดุงุก ูุฅุฏุงุฑุฉ ูุฌููุนุงุช ุงููุณุชุฎุฏููู ูุงูุตูุงุญูุงุช. ุงููุธุงู ูุตูู ููููู ูุงุจู ููุชุฎุตูุต ุจุงููุงูู ุฏูู ุฃู ูููุฏ.

## ูููู ุงููุธุงู ุงูุญุงูู

### 1. ูููุฐุฌ UserGroup (ูุฌููุนุงุช ุงููุณุชุฎุฏููู)
```prisma
model UserGroup {
  id          String   @id @default(cuid())
  name        String   @unique          // ุงุณู ุงููุฌููุนุฉ (ูุงุจู ููุชุฎุตูุต)
  description String?                   // ูุตู ุงููุฌููุนุฉ (ุงุฎุชูุงุฑู)
  isActive    Boolean  @default(true)   // ุญุงูุฉ ุงููุฌููุนุฉ (ูุดุทุฉ/ุบูุฑ ูุดุทุฉ)
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  
  users            User[]              // ุงููุณุชุฎุฏููู ูู ูุฐู ุงููุฌููุนุฉ
  groupPermissions GroupPermission[]   // ุตูุงุญูุงุช ุงููุฌููุนุฉ
}
```

### 2. ูููุฐุฌ Permission (ุงูุตูุงุญูุงุช)
```prisma
model Permission {
  id          String   @id @default(cuid())
  module      String   // ุงููุญุฏุฉ: "Hotels" | "Bookings" | "Users" | "Reports" | ุฃู ูุญุฏุฉ ุฌุฏูุฏุฉ
  action      String   // ุงูุนูููุฉ: "create" | "read" | "update" | "delete" | ุฃู ุนูููุฉ ุฌุฏูุฏุฉ
  description String?  // ูุตู ุงูุตูุงุญูุฉ
  
  groupPermissions GroupPermission[]
  userPermissions  UserPermission[]
}
```

## ุงููุฑููุฉ ุงููุชุงุญุฉ ููุฃุฏูู

### โ ุฅุถุงูุฉ ูุฌููุนุงุช ุฌุฏูุฏุฉ ุจุญุฑูุฉ
- **ูุง ุชูุฌุฏ ูููุฏ** ุนูู ุนุฏุฏ ุงููุฌููุนุงุช
- **ูุง ุชูุฌุฏ ูููุฏ** ุนูู ุฃุณูุงุก ุงููุฌููุนุงุช
- ูููู ุฅูุดุงุก ูุฌููุนุงุช ูุฎุตุตุฉ ูุฃู ุบุฑุถ:
  - ูุฌููุนุงุช ุญุณุจ ุงูุฃูุณุงู (ุงููุญุงุณุจุฉุ ุงูุงุณุชูุจุงูุ ุงูุตูุงูุฉ)
  - ูุฌููุนุงุช ุญุณุจ ุงููุณุชูู (ูุฏูุฑ ุนุงูุ ูุฏูุฑ ูุฑุนุ ููุธู)
  - ูุฌููุนุงุช ุญุณุจ ุงูููุงุฏู (ููุฏู ุงููุงูุฑุฉุ ููุฏู ุงูุฅุณููุฏุฑูุฉ)
  - ุฃู ุชุตููู ุขุฎุฑ

### โ ุฅุถุงูุฉ ุตูุงุญูุงุช ุฌุฏูุฏุฉ ุจุญุฑูุฉ
- **ูุง ุชูุฌุฏ ูููุฏ** ุนูู ุงููุญุฏุงุช (modules)
- **ูุง ุชูุฌุฏ ูููุฏ** ุนูู ุงูุนูููุงุช (actions)
- ูููู ุฅูุดุงุก ุตูุงุญูุงุช ูุฃู ูุญุฏุฉ ุฌุฏูุฏุฉ:
  - ูุญุฏุงุช ููุฌูุฏุฉ: Hotels, Bookings, Users, Reports
  - ูุญุฏุงุช ุฌุฏูุฏุฉ: Maintenance, Inventory, Marketing, Finance
  - ุฃู ูุญุฏุฉ ุฃุฎุฑู

## ุฃูุซูุฉ ุนูู ุงููุฑููุฉ

### ูุฌููุนุงุช ูุฎุตุตุฉ ูููู ุฅูุดุงุคูุง:
```sql
-- ูุฌููุนุงุช ุญุณุจ ุงูุฃูุณุงู
INSERT INTO user_groups (name, description) VALUES 
('ูุณู ุงููุญุงุณุจุฉ', 'ูุณุคูู ุนู ุฌููุน ุงูุนูููุงุช ุงููุงููุฉ'),
('ูุณู ุงูุตูุงูุฉ', 'ูุณุคูู ุนู ุตูุงูุฉ ุงูููุงุฏู ูุงูุบุฑู'),
('ูุณู ุงูุชุณููู', 'ูุณุคูู ุนู ุงูุญููุงุช ุงูุชุณููููุฉ ูุงูุนุฑูุถ');

-- ูุฌููุนุงุช ุญุณุจ ุงููุณุชูู
INSERT INTO user_groups (name, description) VALUES 
('ูุฏูุฑ ุนุงู', 'ุตูุงุญูุงุช ูุงููุฉ ุนูู ุฌููุน ุงูููุงุฏู'),
('ูุฏูุฑ ูุฑุน', 'ุตูุงุญูุงุช ุนูู ููุฏู ูุงุญุฏ ููุท'),
('ูุดุฑู ููุจุฉ', 'ุตูุงุญูุงุช ูุญุฏูุฏุฉ ุฃุซูุงุก ุงูููุจุฉ');

-- ูุฌููุนุงุช ุญุณุจ ุงูููุงุฏู
INSERT INTO user_groups (name, description) VALUES 
('ูุฑูู ููุฏู ุงูููู', 'ููุธูู ููุฏู ุงูููู'),
('ูุฑูู ููุฏู ุงููุฑู', 'ููุธูู ููุฏู ุงููุฑู');
```

### ุตูุงุญูุงุช ูุฎุตุตุฉ ูููู ุฅูุดุงุคูุง:
```sql
-- ุตูุงุญูุงุช ููุตูุงูุฉ
INSERT INTO permissions (module, action, description) VALUES 
('Maintenance', 'create', 'ุฅูุดุงุก ุทูุจ ุตูุงูุฉ ุฌุฏูุฏ'),
('Maintenance', 'assign', 'ุชุนููู ููู ููุตูุงูุฉ'),
('Maintenance', 'complete', 'ุฅููุงุก ุทูุจ ุงูุตูุงูุฉ');

-- ุตูุงุญูุงุช ูููุฎุฒูู
INSERT INTO permissions (module, action, description) VALUES 
('Inventory', 'add_item', 'ุฅุถุงูุฉ ุนูุตุฑ ูููุฎุฒูู'),
('Inventory', 'transfer', 'ููู ุนูุงุตุฑ ุจูู ุงูููุงุฏู'),
('Inventory', 'audit', 'ูุฑุงุฌุนุฉ ุงููุฎุฒูู');

-- ุตูุงุญูุงุช ููุชุณููู
INSERT INTO permissions (module, action, description) VALUES 
('Marketing', 'create_campaign', 'ุฅูุดุงุก ุญููุฉ ุชุณููููุฉ'),
('Marketing', 'send_email', 'ุฅุฑุณุงู ุฑุณุงุฆู ุชุณููููุฉ'),
('Marketing', 'view_analytics', 'ุนุฑุถ ุชุญูููุงุช ุงูุชุณููู');
```

## ูุงุฌูุฉ ุงูุฃุฏูู ุงูููุชุฑุญุฉ

### 1. ุตูุญุฉ ุฅุฏุงุฑุฉ ุงููุฌููุนุงุช
```typescript
// ููููุงุช ูุงุฌูุฉ ุฅุฏุงุฑุฉ ุงููุฌููุนุงุช
interface UserGroupForm {
  name: string;           // ุงุณู ุงููุฌููุนุฉ (ุญูู ููุชูุญ)
  description?: string;   // ูุตู ุงููุฌููุนุฉ (ุงุฎุชูุงุฑู)
  isActive: boolean;      // ุญุงูุฉ ุงููุฌููุนุฉ
  permissions: string[];  // ูุงุฆูุฉ ูุนุฑูุงุช ุงูุตูุงุญูุงุช
}

// API ูุฅูุดุงุก ูุฌููุนุฉ ุฌุฏูุฏุฉ
POST /api/admin/user-groups
{
  "name": "ูุณู ุฎุฏูุฉ ุงูุนููุงุก",
  "description": "ูุณุคูู ุนู ุงูุชุนุงูู ูุน ุดูุงูู ุงูุนููุงุก",
  "isActive": true,
  "permissions": ["perm_1", "perm_2", "perm_3"]
}
```

### 2. ุตูุญุฉ ุฅุฏุงุฑุฉ ุงูุตูุงุญูุงุช
```typescript
// ููููุงุช ูุงุฌูุฉ ุฅุฏุงุฑุฉ ุงูุตูุงุญูุงุช
interface PermissionForm {
  module: string;         // ุงููุญุฏุฉ (ุญูู ููุชูุญ)
  action: string;         // ุงูุนูููุฉ (ุญูู ููุชูุญ)
  description?: string;   // ูุตู ุงูุตูุงุญูุฉ (ุงุฎุชูุงุฑู)
}

// API ูุฅูุดุงุก ุตูุงุญูุฉ ุฌุฏูุฏุฉ
POST /api/admin/permissions
{
  "module": "CustomerService",
  "action": "resolve_complaint",
  "description": "ุญู ุดูุงูู ุงูุนููุงุก"
}
```

## ุฅุนุฏุงุฏุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ุญุงูุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุญุงููุฉ โ
- **Supabase**: ูุชุตูุฉ ูุฌุงูุฒุฉ
- **Database URL**: `postgresql://postgres:moataz1482015@db.bdcndsnjpdhxaezdkgcm.supabase.co:5432/postgres`
- **Host**: `aws-1-eu-north-1.pooler.supabase.com`
- **Database**: `postgres`

### ุงูุฌุฏุงูู ุงูุฌุงูุฒุฉ:
- โ `user_groups` - ูุญูุธ ุงููุฌููุนุงุช
- โ `permissions` - ูุญูุธ ุงูุตูุงุญูุงุช
- โ `group_permissions` - ูุฑุจุท ุงููุฌููุนุงุช ุจุงูุตูุงุญูุงุช
- โ `user_permissions` - ูุตูุงุญูุงุช ูุฑุฏูุฉ ุฅุถุงููุฉ
- โ `users` - ุงููุณุชุฎุฏููู ูุน ุฑุจุทูู ุจุงููุฌููุนุงุช

## ุฎุทูุงุช ุงูุชูููุฐ

### 1. ุฅูุดุงุก ูุงุฌูุงุช ุงูุฃุฏูู
```bash
# ุฅูุดุงุก ุตูุญุงุช ุฅุฏุงุฑุฉ ุงููุฌููุนุงุช
mkdir -p src/app/admin/user-groups
mkdir -p src/app/admin/permissions

# ุฅูุดุงุก ููููุงุช ุงููุงุฌูุฉ
touch src/components/admin/UserGroupForm.tsx
touch src/components/admin/PermissionForm.tsx
touch src/components/admin/UserGroupList.tsx
touch src/components/admin/PermissionList.tsx
```

### 2. ุฅูุดุงุก APIs
```bash
# ุฅูุดุงุก APIs ูููุฌููุนุงุช ูุงูุตูุงุญูุงุช
mkdir -p src/app/api/admin/user-groups
mkdir -p src/app/api/admin/permissions

touch src/app/api/admin/user-groups/route.ts
touch src/app/api/admin/permissions/route.ts
```

### 3. ุชุดุบูู ุงููุงูุฌุฑูุดู
```bash
# ุชุทุจูู ุงูุงุณูููุง ุนูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
npx prisma db push

# ุฅูุดุงุก ุงูุจูุงูุงุช ุงูุฃูููุฉ
npx prisma db seed
```

## ุงูุฎูุงุตุฉ

### โ ุงููุธุงู ูุฏุนู ุจุงููุนู:
1. **ุฅุถุงูุฉ ูุฌููุนุงุช ุจุญุฑูุฉ ูุงููุฉ** - ูุง ุชูุฌุฏ ูููุฏ ุนูู ุงูุฃุณูุงุก ุฃู ุงูุนุฏุฏ
2. **ุฅุถุงูุฉ ุตูุงุญูุงุช ุจุญุฑูุฉ ูุงููุฉ** - ูุง ุชูุฌุฏ ูููุฏ ุนูู ุงููุญุฏุงุช ุฃู ุงูุนูููุงุช
3. **ุฑุจุท ูุฑู** ุจูู ุงููุฌููุนุงุช ูุงูุตูุงุญูุงุช
4. **ุตูุงุญูุงุช ูุฑุฏูุฉ ุฅุถุงููุฉ** ูููุณุชุฎุฏููู
5. **ูุงุนุฏุฉ ุจูุงูุงุช ุฌุงูุฒุฉ** ุนูู Supabase
6. **ูุงุฌูุงุช ุงูุฅุฏุงุฑุฉ (Admin UI) ููุชููุฉ**
7. **APIs ููุฅุฏุงุฑุฉ ููุชููุฉ**

### ๐ ุงููููุงุช ุงููููุดุฃุฉ:

#### ูุงุฌูุงุช ุงููุณุชุฎุฏู:
- `src/components/admin/UserGroupManager.tsx` - ุฅุฏุงุฑุฉ ุงููุฌููุนุงุช
- `src/components/admin/PermissionManager.tsx` - ุฅุฏุงุฑุฉ ุงูุตูุงุญูุงุช
- `src/app/admin/groups/page.tsx` - ุตูุญุฉ ุงูุฅุฏุงุฑุฉ ุงูุฑุฆูุณูุฉ

#### APIs:
- `src/app/api/admin/user-groups/route.ts` - ุฅุฏุงุฑุฉ ุงููุฌููุนุงุช
- `src/app/api/admin/user-groups/[id]/route.ts` - ุฅุฏุงุฑุฉ ูุฌููุนุฉ ูุงุญุฏุฉ
- `src/app/api/admin/user-groups/[id]/permissions/route.ts` - ุตูุงุญูุงุช ุงููุฌููุนุฉ
- `src/app/api/admin/permissions/route.ts` - ุฅุฏุงุฑุฉ ุงูุตูุงุญูุงุช
- `src/app/api/admin/permissions/[id]/route.ts` - ุฅุฏุงุฑุฉ ุตูุงุญูุฉ ูุงุญุฏุฉ

### ๐ ูุง ูุญุชุงุฌ ุชูููุฐ:
1. **ุชุทุจูู ูุธุงู ุงูุชุญูู ูู ุงูุตูุงุญูุงุช** ูู ุงูุชุทุจูู
2. **ุฅุถุงูุฉ middleware ููุญูุงูุฉ**
3. **ุงุฎุชุจุงุฑ ุงููุธุงู**

ุงููุธุงู ูุตูู ููููู **ูุฑู ุจุงููุงูู** ููุณูุญ ููุฃุฏูู ุจุฅูุดุงุก ุฃู ุชุตูููุงุช ุฃู ุตูุงุญูุงุช ูุญุชุงุฌูุง ุฏูู ุฃู ูููุฏ ุชูููุฉ.